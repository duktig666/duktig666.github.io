(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{496:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、jvm调优参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、jvm调优参数"}},[s._v("#")]),s._v(" 一、JVM调优参数")]),s._v(" "),a("h3",{attrs:{id:"_1-1-jvm-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-jvm-参数"}},[s._v("#")]),s._v(" 1.1 JVM 参数")]),s._v(" "),a("h4",{attrs:{id:"xms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xms"}},[s._v("#")]),s._v(" -Xms")]),s._v(" "),a("p",[s._v("堆最小值")]),s._v(" "),a("p",[s._v("默认情况下，初始堆内存大小为：电脑内存大小/64")]),s._v(" "),a("h4",{attrs:{id:"xmx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmx"}},[s._v("#")]),s._v(" -Xmx")]),s._v(" "),a("p",[s._v("堆最大堆值。-Xms与-Xmx 的单位默认字节都是以k、m做单位的。")]),s._v(" "),a("p",[s._v("默认情况下，最大堆内存大小为：电脑内存大小/4")]),s._v(" "),a("p",[s._v("我们通常会将 "),a("code",[s._v("-Xmx")]),s._v(" 和 "),a("code",[s._v("-Xms")]),s._v(" 两个参数配置为相同的值，其目的是为了能够在垃圾回收机制清理完堆区后不再需要重新分隔计算堆的大小，从而提高性能")]),s._v(" "),a("h4",{attrs:{id:"xmn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmn"}},[s._v("#")]),s._v(" -Xmn")]),s._v(" "),a("p",[s._v("新生代大小")]),s._v(" "),a("h4",{attrs:{id:"xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss"}},[s._v("#")]),s._v(" -Xss")]),s._v(" "),a("p",[s._v("每个线程池的堆栈大小。在jdk5以上的版本，每个线程堆栈大小为1m，jdk5以前的版本是每个线程池大小为256k。一般在相同物理内存下，如果减少－xss值会产生更大的线程数，但不同的操作系统对进程内线程数是有限制的，是不能无限生成。")]),s._v(" "),a("h4",{attrs:{id:"xx-newratio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-newratio"}},[s._v("#")]),s._v(" -XX:NewRatio")]),s._v(" "),a("p",[s._v("设置新生代与老年代比值，-XX:NewRatio=4 表示新生代与老年代所占比例为1:4 ，新生代占比整个堆的五分之一。如果设置了-Xmn的情况下，该参数是不需要在设置的。")]),s._v(" "),a("h4",{attrs:{id:"xx-permsize"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-permsize"}},[s._v("#")]),s._v(" -XX:PermSize")]),s._v(" "),a("p",[s._v("设置持久代初始值，默认是物理内存的六十四分之一")]),s._v(" "),a("h4",{attrs:{id:"xx-maxpermsize"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-maxpermsize"}},[s._v("#")]),s._v(" -XX:MaxPermSize")]),s._v(" "),a("p",[s._v("设置持久代最大值，默认是物理内存的四分之一")]),s._v(" "),a("h4",{attrs:{id:"xx-maxtenuringthreshold"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-maxtenuringthreshold"}},[s._v("#")]),s._v(" -XX:MaxTenuringThreshold")]),s._v(" "),a("p",[s._v("新生代中对象存活次数，默认15。(若对象在eden区，经历一次MinorGC后还活着，则被移动到Survior区，年龄加1。以后，对象每次经历MinorGC，年龄都加1。达到阀值，则移入老年代)")]),s._v(" "),a("h4",{attrs:{id:"xx-survivorratio"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-survivorratio"}},[s._v("#")]),s._v(" XX:SurvivorRatio")]),s._v(" "),a("p",[s._v("Eden区与Subrvivor区大小的比值，如果设置为8，两个Subrvivor区与一个Eden区的比值为2:8，一个Survivor区占整个新生代的十分之一")]),s._v(" "),a("h4",{attrs:{id:"xx-usefastaccessormethods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-usefastaccessormethods"}},[s._v("#")]),s._v(" -XX:+UseFastAccessorMethods")]),s._v(" "),a("p",[s._v("原始类型快速优化")]),s._v(" "),a("h4",{attrs:{id:"xx-aggressiveopts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-aggressiveopts"}},[s._v("#")]),s._v(" -XX:+AggressiveOpts")]),s._v(" "),a("p",[s._v("编译速度加快")]),s._v(" "),a("h4",{attrs:{id:"xx-pretenuresizethreshold"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-pretenuresizethreshold"}},[s._v("#")]),s._v(" -XX:PretenureSizeThreshold")]),s._v(" "),a("p",[s._v("对象超过多大值时直接在老年代中分配")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("说明:")]),s._v("\n整个堆大小的计算公式: JVM 堆大小 ＝ 年轻代大小＋年老代大小＋持久代大小。\n增大新生代大小就会减少对应的年老代大小，设置-Xmn值对系统性能影响较大，所以如果设置新生代大小的调整，则需要严格的测试调整。而新生代是用来存放新创建的对象，大小是随着堆大小增大和减少而有相应的变化，默认值是保持堆大小的十五分之一，-Xmn参数就是设置新生代的大小，也可以通过-XX:NewRatio来设置新生代与年老代的比例，java 官方推荐配置为3:8。")]),s._v(" "),a("p",[s._v("新生代的特点就是内存中的对象更新速度快，在短时间内容易产生大量的无用对象，如果在这个参数时就需要考虑垃圾回收器设置参数也需要调整。推荐使用: 复制清除算法和并行收集器进行垃圾回收，而新生代的垃圾回收叫做初级回收。")])]),s._v(" "),a("blockquote",[a("p",[s._v("StackOverflowError和OutOfMemoryException。当线程中的请求的栈的深度大于最大可用深度，就会抛出前者；若内存空间不够，无法创建新的线程，则会抛出后者。栈的大小直接决定了函数的调用最大深度，栈越大，函数嵌套可调用次数就越多。")])]),s._v(" "),a("h4",{attrs:{id:"经验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#经验"}},[s._v("#")]),s._v(" 经验")]),s._v(" "),a("ol",[a("li",[s._v("Xmn用于设置新生代的大小。过小会增加Minor GC频率，过大会减小老年代的大小。一般设为整个堆空间的1/4或1/3.")]),s._v(" "),a("li",[s._v("XX:SurvivorRatio用于设置新生代中survivor空间(from/to)和eden空间的大小比例； XX:TargetSurvivorRatio表示，当经历Minor GC后，survivor空间占有量(百分比)超过它的时候，就会压缩进入老年代(当然，如果survivor空间不够，则直接进入老年代)。默认值为50%。")]),s._v(" "),a("li",[s._v("为了性能考虑，一开始尽量将新生代对象留在新生代，避免新生的大对象直接进入老年代。因为新生对象大部分都是短期的，这就造成了老年代的内存浪费，并且回收代价也高(Full GC发生在老年代和方法区Perm).")]),s._v(" "),a("li",[s._v("当Xms=Xmx，可以使得堆相对稳定，避免不停震荡")]),s._v(" "),a("li",[s._v("一般来说，MaxPermSize设为64MB可以满足绝大多数的应用了。若依然出现方法区溢出，则可以设为128MB。若128MB还不能满足需求，那么就应该考虑程序优化了，减少"),a("strong",[s._v("动态类")]),s._v("的产生。")])]),s._v(" "),a("h3",{attrs:{id:"_1-2-回收器的jvm参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-回收器的jvm参数"}},[s._v("#")]),s._v(" 1.2 回收器的JVM参数")]),s._v(" "),a("h4",{attrs:{id:"xx-useserialgc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-useserialgc"}},[s._v("#")]),s._v(" -XX:+UseSerialGC")]),s._v(" "),a("p",[s._v("​\t串行垃圾回收，现在基本很少使用。")]),s._v(" "),a("h4",{attrs:{id:"xx-useparnewgc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-useparnewgc"}},[s._v("#")]),s._v(" -XX:+UseParNewGC")]),s._v(" "),a("p",[s._v("​\t新生代使用并行，老年代使用串行；")]),s._v(" "),a("h4",{attrs:{id:"xx-useconcmarksweepgc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-useconcmarksweepgc"}},[s._v("#")]),s._v(" -XX:+UseConcMarkSweepGC")]),s._v(" "),a("p",[s._v("​\t新生代使用并行，老年代使用CMS(一般都是使用这种方式)，CMS是Concurrent Mark Sweep的缩写，并发标记清除，一看就是老年代的算法，所以，它可以作为老年代的垃圾回收器。CMS不是独占式的，它关注停顿时间")]),s._v(" "),a("h4",{attrs:{id:"xx-parallelgcthreads"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-parallelgcthreads"}},[s._v("#")]),s._v(" -XX:ParallelGCThreads")]),s._v(" "),a("p",[s._v("​\t指定并行的垃圾回收线程的数量，最好等于CPU数量")]),s._v(" "),a("h4",{attrs:{id:"xx-disableexplicitgc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-disableexplicitgc"}},[s._v("#")]),s._v(" -XX:+DisableExplicitGC")]),s._v(" "),a("p",[s._v("​\t禁用System.gc()，因为它会触发Full GC，这是很浪费性能的，JVM会在需要GC的时候自己触发GC。")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsfullgcsbeforecompaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsfullgcsbeforecompaction"}},[s._v("#")]),s._v(" -XX:CMSFullGCsBeforeCompaction")]),s._v(" "),a("p",[s._v("​\t在多少次GC后进行内存压缩，这个是因为并行收集器不对内存空间进行压缩的，所以运行一段时间后会产生很多碎片，使得运行效率降低。")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsparallelremarkenabled"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsparallelremarkenabled"}},[s._v("#")]),s._v(" -XX:+CMSParallelRemarkEnabled")]),s._v(" "),a("p",[s._v("​\t降低标记停顿")]),s._v(" "),a("h4",{attrs:{id:"xx-usecmscompactatfullcollection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-usecmscompactatfullcollection"}},[s._v("#")]),s._v(" -XX:+UseCMSCompactAtFullCollection")]),s._v(" "),a("p",[s._v("​\t在每一次Full GC时对老年代区域碎片整理，因为CMS是不会移动内存的，因此会非常容易出现碎片导致内存不够用的")]),s._v(" "),a("h4",{attrs:{id:"xx-usecmsinitiatingoccupancyonly"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-usecmsinitiatingoccupancyonly"}},[s._v("#")]),s._v(" -XX:+UseCmsInitiatingOccupancyOnly")]),s._v(" "),a("p",[s._v("​\t使用手动触发或者自定义触发cms 收集，同时也会禁止hostspot 自行触发CMS GC")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsinitiatingoccupancyfraction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsinitiatingoccupancyfraction"}},[s._v("#")]),s._v(" -XX:CMSInitiatingOccupancyFraction")]),s._v(" "),a("p",[s._v("​\t使用CMS作为垃圾回收，使用70%后开始CMS收集")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsinitiatingpermoccupancyfraction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsinitiatingpermoccupancyfraction"}},[s._v("#")]),s._v(" -XX:CMSInitiatingPermOccupancyFraction")]),s._v(" "),a("p",[s._v("​\t设置perm gen使用达到多少％比时触发垃圾回收，默认是92%")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsincrementalmode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsincrementalmode"}},[s._v("#")]),s._v(" -XX:+CMSIncrementalMode")]),s._v(" "),a("p",[s._v("​\t设置为增量模式")]),s._v(" "),a("h4",{attrs:{id:"xx-cmsclassunloadingenabled"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-cmsclassunloadingenabled"}},[s._v("#")]),s._v(" -XX:+CmsClassUnloadingEnabled")]),s._v(" "),a("p",[s._v("​\tCMS是不会默认对永久代进行垃圾回收的，设置此参数则是开启")]),s._v(" "),a("h4",{attrs:{id:"xx-printgcdetails"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-printgcdetails"}},[s._v("#")]),s._v(" -XX:+PrintGCDetails")]),s._v(" "),a("p",[s._v("​\t开启详细GC日志模式，日志的格式是和所使用的算法有关")]),s._v(" "),a("h4",{attrs:{id:"xx-printgcdatestamps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xx-printgcdatestamps"}},[s._v("#")]),s._v(" -XX:+PrintGCDateStamps")]),s._v(" "),a("p",[s._v("​\t将时间和日期也加入到GC日志中")]),s._v(" "),a("h2",{attrs:{id:"二、java-oom分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、java-oom分析"}},[s._v("#")]),s._v(" 二、Java OOM分析")]),s._v(" "),a("h3",{attrs:{id:"_2-1-java-堆内存溢出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-java-堆内存溢出"}},[s._v("#")]),s._v(" 2.1 Java 堆内存溢出")]),s._v(" "),a("p",[s._v("在 Java 堆中只要不断的创建对象，并且 "),a("code",[s._v("GC-Roots")]),s._v(" 到对象之间存在引用链，这样 "),a("code",[s._v("JVM")]),s._v(" 就不会回收对象。")]),s._v(" "),a("p",[s._v("只要将"),a("code",[s._v("-Xms(最小堆)")]),s._v(","),a("code",[s._v("-Xmx(最大堆)")]),s._v(" 设置为一样禁止自动扩展堆内存。")]),s._v(" "),a("p",[s._v("当使用一个 "),a("code",[s._v("while(true)")]),s._v(" 循环来不断创建对象就会发生 "),a("code",[s._v("OutOfMemory")]),s._v("，还可以使用 "),a("code",[s._v("-XX:+HeapDumpOutofMemoryErorr")]),s._v(" 当发生 OOM 时会自动 dump 堆栈到文件中。")]),s._v(" "),a("p",[s._v("伪代码:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("当出现 OOM 时可以通过工具来分析 "),a("code",[s._v("GC-Roots")]),s._v(" "),a("a",{attrs:{href:"https://github.com/crossoverJie/Java-Interview/blob/master/MD/GarbageCollection.md#%E5%8F%AF%E8%BE%BE%E6%80%A7%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95",target:"_blank",rel:"noopener noreferrer"}},[s._v("引用链  (opens new window)"),a("OutboundLink")],1),s._v(" ，查看对象和 "),a("code",[s._v("GC-Roots")]),s._v(" 是如何进行关联的，是否存在对象的生命周期过长，或者是这些对象确实改存在的，那就要考虑将堆内存调大了。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" in thread "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("OutOfMemoryError")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Java")]),s._v(" heap space\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3210")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3181")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("261")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ensureExplicitCapacity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("235")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ensureCapacityInternal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("227")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("458")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crossoverjie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("oom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("HeapOOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HeapOOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NativeMethodAccessorImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invoke0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Native")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NativeMethodAccessorImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NativeMethodAccessorImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("DelegatingMethodAccessorImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DelegatingMethodAccessorImpl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("498")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tat "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("intellij"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("execution"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("AppMain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AppMain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("147")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Process")]),s._v(" finished "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("exit")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[a("code",[s._v("java.lang.OutOfMemoryError: Java heap space")]),s._v("表示堆内存溢出。")]),s._v(" "),a("h3",{attrs:{id:"_2-2-metaspace-元数据-内存溢出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-metaspace-元数据-内存溢出"}},[s._v("#")]),s._v(" 2.2 MetaSpace (元数据) 内存溢出")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("JDK8")]),s._v(" 中将永久代移除，使用 "),a("code",[s._v("MetaSpace")]),s._v(" 来保存类加载之后的类信息，字符串常量池也被移动到 Java 堆。")])]),s._v(" "),a("p",[a("code",[s._v("PermSize")]),s._v(" 和 "),a("code",[s._v("MaxPermSize")]),s._v(" 已经不能使用了，在 JDK8 中配置这两个参数将会发出警告。")]),s._v(" "),a("p",[s._v("JDK 8 中将类信息移到到了本地堆内存(Native Heap)中，将原有的永久代移动到了本地堆中成为 "),a("code",[s._v("MetaSpace")]),s._v(" ,如果不指定该区域的大小，JVM 将会动态的调整。")]),s._v(" "),a("p",[s._v("可以使用 "),a("code",[s._v("-XX:MaxMetaspaceSize=10M")]),s._v(" 来限制最大元数据。这样当不停的创建类时将会占满该区域并出现 "),a("code",[s._v("OOM")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Enhancer")]),s._v("  enhancer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Enhancer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            enhancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setSuperclass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HeapOOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            enhancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUseCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            enhancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MethodInterceptor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("intercept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Method")]),s._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MethodProxy")]),s._v(" methodProxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" methodProxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            enhancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("使用 "),a("code",[s._v("cglib")]),s._v(" 不停的创建新类，最终会抛出:")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Caused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat net.sf.cglib.core.ReflectUtils.defineClass(ReflectUtils.java:459)\n\tat net.sf.cglib.core.AbstractClassGenerator.generate(AbstractClassGenerator.java:336)\n\t... 11 more\nCaused by: java.lang.OutOfMemoryError: Metaspace\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763)\n\t... 16 more   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("注意: 这里的 OOM 伴随的是 "),a("code",[s._v("java.lang.OutOfMemoryError: Metaspace")]),s._v(" 也就是元数据溢出。")]),s._v(" "),a("h2",{attrs:{id:"三、java线程dump分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、java线程dump分析"}},[s._v("#")]),s._v(" 三、Java线程Dump分析")]),s._v(" "),a("h2",{attrs:{id:"四、java问题排查-linux命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、java问题排查-linux命令"}},[s._v("#")]),s._v(" 四、Java问题排查：Linux命令")]),s._v(" "),a("h3",{attrs:{id:"_4-1-文本操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-文本操作"}},[s._v("#")]),s._v(" 4.1 文本操作")]),s._v(" "),a("h4",{attrs:{id:"_4-1-1-文件查找-grep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-文件查找-grep"}},[s._v("#")]),s._v(" 4.1.1 文件查找 - grep")]),s._v(" "),a("p",[s._v("grep常用命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基本使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" yoursearchkeyword f.txt     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件查找")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'KeyWord otherKeyWord'")]),s._v(" f.txt cpf.txt "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多文件查找, 含空格加引号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'KeyWord'")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#目录下查找所有符合关键字的文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'keyword'")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -i 忽略大小写")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'KeyWord'")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--include")]),s._v(" *."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("vm,java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定文件后缀")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'KeyWord'")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--exclude")]),s._v(" *."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("vm,java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#反匹配")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat + grep")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" f.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" keyword "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找所有keyword且不分大小写  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" f.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'KeyWord'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 统计Keyword次数")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# seq + grep")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上匹配")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-B")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下匹配")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上下匹配，平时用这个就妥了")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("Grep的参数：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto：显示颜色"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-i, --ignore-case：忽略字符大小写"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-o, --only-matching：只显示匹配到的部分"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-n, --line-number：显示行号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-v, --invert-match：反向显示,显示未匹配到的行"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-E, --extended-regexp：支持使用扩展的正则表达式"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-q, --quiet, --silent：静默模式,即不输出任何信息"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-w, --word-regexp：整行匹配整个单词"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-c, --count：统计匹配到的行数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" print a count of matching lines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n-B, --before-context"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NUM：print NUM lines of leading context   后"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#行 ")]),s._v("\n-A, --after-context"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NUM：print NUM lines of trailing context   前"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#行 ")]),s._v("\n-C, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--context")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NUM：print NUM lines of output context           前后各"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#行 ")]),s._v("\n  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_4-1-2-文本分析-awk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-文本分析-awk"}},[s._v("#")]),s._v(" 4.1.2 文本分析 - awk")]),s._v(" "),a("p",[s._v("awk基本命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基本使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $4,$6}'")]),s._v(" f.txt\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print NR,$0}'")]),s._v(" f.txt cpf.txt    \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print FNR,$0}'")]),s._v(" f.txt cpf.txt\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print FNR,FILENAME,$0}'")]),s._v(" f.txt cpf.txt\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{print FILENAME,"NR="NR,"FNR="FNR,"$"NF"="$NF}\'')]),s._v(" f.txt cpf.txt\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":2:3:4 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1,$2,$3,$4}'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/ldb/ {print}'")]),s._v(" f.txt   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#匹配ldb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'!/ldb/ {print}'")]),s._v(" f.txt  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不匹配ldb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/ldb/ && /LISTEN/ {print}'")]),s._v(" f.txt   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#匹配ldb和LISTEN")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$5 ~ /ldb/ {print}'")]),s._v(" f.txt "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第五列匹配ldb")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("内建变量")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("NR"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" NR表示从awk开始执行后，按照记录分隔符读取的数据次数，默认的记录分隔符为换行符，因此默认的就是读取的数据行数，NR可以理解为Number of Record的缩写。\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("FNR"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 在awk处理多个输入文件的时候，在处理完第一个文件后，NR并不会从1开始，而是继续累加，因此就出现了FNR，每当处理一个新文件的时候，FNR就从1开始计数，FNR可以理解为File Number of Record。\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("NF"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" NF表示目前的记录被分割的字段的数目，NF可以理解为Number of Field。\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"_4-1-3-文本处理-sed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-文本处理-sed"}},[s._v("#")]),s._v(" 4.1.3 文本处理 - sed")]),s._v(" "),a("p",[s._v("sed常用")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文本打印")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3p'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只打印第三行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$p'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只打印最后一行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3,9p'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只查看文件的第3行到第9行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3,9p'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#打印3-9行，并显示行号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/root/p'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示包含root的行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/hhh/,/omc/p'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 显示包含"hhh"的行到包含"omc"的行之间的行')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文本替换")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/root/world/g'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用world 替换xxx.log文件中的root; s==search  查找并替换, g==global  全部替换, -i: implace")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文本插入")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1,4i hahaha'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在文件第一行和第四行的每行下面添加hahaha")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1i happy'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$a new year'")]),s._v(" xxx.log  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#【界面显示】在文件第一行添加happy,文件结尾添加new year")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1i happy'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$a new year'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#【真实写入文件】在文件第一行添加happy,文件结尾添加new year")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文本删除")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3,9d'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除第3到第9行,只是不显示而已")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/hhh/,/omc/d'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 删除包含"hhh"的行到包含"omc"的行之间的行')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/omc/,10d'")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 删除包含"omc"的行到第十行的内容')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与find结合")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.txt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/hhhh/\\hHHh/g'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.txt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s#hhhh#hHHh#g'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.txt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/hhhh/\\hHHh/g'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.txt"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h3",{attrs:{id:"_4-2-文件操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-文件操作"}},[s._v("#")]),s._v(" 4.2 文件操作")]),s._v(" "),a("h4",{attrs:{id:"_4-2-1-文件监听-tail"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-文件监听-tail"}},[s._v("#")]),s._v(" 4.2.1 文件监听 - tail")]),s._v(" "),a("p",[s._v("最常用的"),a("code",[s._v("tail -f filename")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基本使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 循环监听文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-300f")]),s._v(" xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#倒数300行并追踪文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" +20 xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#从第 20 行至文件末尾显示文件内容")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tailf使用")]),s._v("\ntailf xxx.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#等同于tail -f -n 10 打印最后10行，然后追踪文件")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("tail -f 与tail F 与tailf三者区别")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("  等于--follow"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("descriptor，根据文件描述进行追踪，当文件改名或删除后，停止追踪。\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" 等于 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--follow")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("retry，根据文件名字进行追踪，当文件改名或删除后，保持重试，当有新的文件和他同名时，继续追踪\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("tailf"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" 等于tail "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("（tail -f或-F默认也是打印最后10行，然后追踪文件），与tail -f不同的是，如果文件不增长，它不会去访问磁盘文件，所以tailf特别适合那些便携机上跟踪日志文件，因为它减少了磁盘访问，可以省电。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("tail的参数")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 循环读取\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" 不显示处理信息\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 显示详细的处理信息\n-c"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("数目"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示的字节数\n-n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("行数"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 显示文件的尾部 n 行内容\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PID 与-f合用,表示在进程ID,PID死掉之后结束\n-q, --quiet, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--silent")]),s._v(" 从不输出给出文件名的首部\n-s, --sleep-interval"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("S 与-f合用,表示在每次反复的间隔休眠S秒\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"_4-2-2-文件查找-find"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-文件查找-find"}},[s._v("#")]),s._v(" 4.2.2 文件查找 - find")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" admin "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin /tmp /usr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("*.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("多个目录去找"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-iname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("*.txt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("大小写都匹配"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-type")]),s._v(" d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("当前目录下的所有子目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /usr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-type")]),s._v(" l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("当前目录下所有的符号链接"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /usr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-type")]),s._v(" l "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"z*"')]),s._v(" -ls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("符号链接的详细信息 eg:inode,目录"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-size")]),s._v(" +250000k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("超过250000k的文件，当然+改成-就是小于了"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin f "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-perm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("按照权限查询文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-atime")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("天内访问过的文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ctime")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("天内状态改变过的文件    \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-mtime")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("天内修改过的文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-amin")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("分钟内访问过的文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-cmin")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("分钟内状态改变过的文件    \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /home/admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-mmin")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("分钟内修改过的文件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"_4-2-3-pgm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-pgm"}},[s._v("#")]),s._v(" 4.2.3 pgm")]),s._v(" "),a("p",[s._v("批量查询vm-shopbase满足条件的日志")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pgm "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" vm-shopbase "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cat /home/admin/shopbase/logs/shopbase.log.2017-01-17|grep 2069861630'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4-3-查看网络和进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-查看网络和进程"}},[s._v("#")]),s._v(" 4.3 查看网络和进程")]),s._v(" "),a("h4",{attrs:{id:"_4-3-1-查看所有网络接口的属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-查看所有网络接口的属性"}},[s._v("#")]),s._v(" 4.3.1 查看所有网络接口的属性")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ifconfig")]),s._v("\neth0: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("416")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,BROADCAST,RUNNING,MULTICAST"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("\n        inet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194  netmask "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".240.0  broadcast "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".175.255\n        ether 00:16:3e:08:c1:ea  txqueuelen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ethernet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21213152")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2812084823")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.6")]),s._v(" GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25264438")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("46566724676")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43.3")]),s._v(" GiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\nlo: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,LOOPBACK,RUNNING"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n        inet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1  netmask "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.0")]),s._v(".0.0\n        loop  txqueuelen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Local Loopback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86350")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("84.3")]),s._v(" KiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86350")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("84.3")]),s._v(" KiB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h4",{attrs:{id:"_4-3-2-查看防火墙设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-查看防火墙设置"}},[s._v("#")]),s._v(" 4.3.2 查看防火墙设置")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# iptables -L")]),s._v("\nChain INPUT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget     prot opt "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n\nChain FORWARD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget     prot opt "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n\nChain OUTPUT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("policy ACCEPT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget     prot opt "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("               destination\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"_4-3-3-查看路由表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-查看路由表"}},[s._v("#")]),s._v(" 4.3.3 查看路由表")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@pdai.tech")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# route "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Kernel")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v(" routing table\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Destination")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Gateway")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Genmask")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Flags")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metric")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ref")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Use")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Iface")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".175")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".253")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UG")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" eth0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("169.254")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1002")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" eth0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".160")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".240")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" eth0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"_4-3-4-netstat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-4-netstat"}},[s._v("#")]),s._v(" 4.3.4 netstat")]),s._v(" "),a("p",[s._v("查看所有监听端口")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -lntp")]),s._v("\nActive Internet connections "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("only servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name  \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:443             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v("/nginx: master p\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9999            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1249")]),s._v("/java         \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v("/nginx: master p\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:22              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1547")]),s._v("/sshd         \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::3306                 :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1894")]),s._v("/mysqld       \n    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("查看所有已经建立的连接")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -antp")]),s._v("\nActive Internet connections "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("servers and established"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:443             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v("/nginx: master p\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9999            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1249")]),s._v("/java\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("970")]),s._v("/nginx: master p\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:22              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1547")]),s._v("/sshd\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194:53874    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.100")]),s._v(".30.25:80        ESTABLISHED "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18041")]),s._v("/AliYunDun\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194:22       xxx.194.1.200:2649      ESTABLISHED "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32516")]),s._v("/sshd: root@pt\ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::3306                 :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1894")]),s._v("/m\n \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("查看当前连接")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -nat|awk  '{print $6}'|sort|uniq -c|sort -rn")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" LISTEN\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" ESTABLISHED\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" Foreign\n      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" established"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("查看网络统计信息进程")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -s")]),s._v("\nIp:\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21017132")]),s._v(" total packets received\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" forwarded\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" incoming packets discarded\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21017131")]),s._v(" incoming packets delivered\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25114367")]),s._v(" requests sent out\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("324")]),s._v(" dropped because of missing route\nIcmp:\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18088")]),s._v(" ICMP messages received\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("692")]),s._v(" input ICMP message failed.\n    ICMP input histogram:\n        destination unreachable: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4241")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" transit: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" requests: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13791")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" replies: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n        timestamp request: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13825")]),s._v(" ICMP messages sent\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ICMP messages failed\n    ICMP output histogram:\n        destination unreachable: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" replies: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13791")]),s._v("\n        timestamp replies: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\nIcmpMsg:\n        InType0: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n        InType3: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4241")]),s._v("\n        InType8: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13791")]),s._v("\n        InType11: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("\n        InType13: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\n        OutType0: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13791")]),s._v("\n        OutType3: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        OutType14: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\nTcp:\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12210")]),s._v(" active connections openings\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("208820")]),s._v(" passive connection openings\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("54198")]),s._v(" failed connection attempts\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9805")]),s._v(" connection resets received\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("h4",{attrs:{id:"_4-3-5-查看所有进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-5-查看所有进程"}},[s._v("#")]),s._v(" 4.3.5 查看所有进程")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai.tech ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef | grep java")]),s._v("\nroot      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1249")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Nov04 ?        00:58:05 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" /opt/tech_doc/bin/tech_arch-0.0.1-RELEASE.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--server.port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v("\nroot     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32718")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32518")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 08:36 pts/0    00:00:00 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--color")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看进程及占用CPU及内存")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nr")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用sort对CPU占用进行排序")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sort #排序命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -nr #默认使用字符串排序n代表使用数值进行排序 默认从小到大排序 r代表反向排序")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -k3 #以第3列进行排序")]),s._v("\n\t\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" -n1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nr")]),s._v(" -k3"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如需要显示PID则先运行输出第一行然后再进行排序")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_4-3-6-top"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-6-top"}},[s._v("#")]),s._v(" 4.3.6 top")]),s._v(" "),a("p",[s._v("top除了看一些基本信息之外，剩下的就是配合来查询vm的各种问题了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# top -H -p pid")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" - 08:37:51 up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(" days, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":45,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v("\nThreads:  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" total,   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" running,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" sleeping,   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" stopped,   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" zombie\n%Cpu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),s._v(" us,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),s._v(" sy,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" ni, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("98.6")]),s._v(" id,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" wa,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" hi,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" si,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" st\nKiB Mem "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1882088")]),s._v(" total,    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("74608")]),s._v(" free,   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("202228")]),s._v(" used,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1605252")]),s._v(" buff/cache\nKiB Swap:  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097148")]),s._v(" total,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1835392")]),s._v(" free,   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("261756")]),s._v(" used.  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1502036")]),s._v(" avail Mem\n\n  PID "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1347")]),s._v(" root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2553808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113752")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" S  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v(":46.74 VM Periodic Tas\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1249")]),s._v(" root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2553808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113752")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" S  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00.00 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1289")]),s._v(" root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2553808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113752")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" S  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":03.74 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"五、java调试工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、java调试工具"}},[s._v("#")]),s._v(" 五、Java调试工具")]),s._v(" "),a("h3",{attrs:{id:"_5-1-入门工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-入门工具"}},[s._v("#")]),s._v(" 5.1 入门工具")]),s._v(" "),a("h4",{attrs:{id:"_5-1-1-jps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-jps"}},[s._v("#")]),s._v(" 5.1.1 jps")]),s._v(" "),a("p",[s._v("著作权归https://pdai.tech所有。 链接：https://www.pdai.tech/md/java/jvm/java-jvm-debug-tools-list.html")]),s._v(" "),a("blockquote",[a("p",[s._v("jps是jdk提供的一个查看当前java进程的小工具， 可以看做是JavaVirtual Machine Process Status Tool的缩写。")])]),s._v(" "),a("p",[s._v("jps常用命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("jps "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示进程的ID 和 类的名称")]),s._v("\njps –l "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出输出完全的包名，应用主类名，jar的完全路径名 ")]),s._v("\njps –v "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出jvm参数")]),s._v("\njps –q "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示java进程号")]),s._v("\njps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main 方法")]),s._v("\njps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" xxx.xxx.xx.xx "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程查看  ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("jps参数")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("-q：仅输出VM标识符，不包括classname,jar name,arguments "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" main method \n-m：输出main method的参数 \n-l：输出完全的包名，应用主类名，jar的完全路径名 \n-v：输出jvm参数 \n-V：输出通过flag文件传递到JVM中的参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".hotspotrc文件或-XX:Flags"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("所指定的文件 \n-Joption：传递参数到vm,例如:-J-Xms512m\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("java程序在启动以后，会在java.io.tmpdir指定的目录下，就是临时文件夹里，生成一个类似于hsperfdata_User的文件夹，这个文件夹里（在Linux中为/tmp/hsperfdata_{userName}/），有几个文件，名字就是java进程的pid，因此列出当前运行的java进程，只是把这个目录里的文件名列一下而已。 至于系统的参数什么，就可以解析这几个文件获得。")])]),s._v(" "),a("h4",{attrs:{id:"_5-1-2-jstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-jstack"}},[s._v("#")]),s._v(" 5.1.2 jstack")]),s._v(" "),a("blockquote",[a("p",[s._v("jstack是jdk自带的线程堆栈分析工具，使用该命令可以查看或导出 Java 应用程序中线程堆栈信息。")])]),s._v(" "),a("p",[s._v("jstack常用命令:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基本")]),s._v("\njstack "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java和native c/c++框架的所有栈信息")]),s._v("\njstack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 额外的锁信息列表，查看是否死锁")]),s._v("\njstack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("jstack参数：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" 长列表. 打印关于锁的附加信息,例如属于java.util.concurrent 的 ownable synchronizers列表.\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),s._v(" 当’jstack "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pid’没有相应的时候强制打印栈信息\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" 打印java和native c/c++框架的所有栈信息.\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-help")]),s._v(" 打印帮助信息\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_5-1-3-jinfo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-3-jinfo"}},[s._v("#")]),s._v(" 5.1.3 jinfo")]),s._v(" "),a("blockquote",[a("p",[s._v("jinfo 是 JDK 自带的命令，可以用来查看正在运行的 java 应用程序的扩展参数，包括Java System属性和JVM命令行参数；也可以动态的修改正在运行的 JVM 一些参数。当系统崩溃时，jinfo可以从core文件里面知道崩溃的Java应用程序的配置信息")])]),s._v(" "),a("p",[s._v("jinfo常用命令:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前 jvm 进程的全部参数和系统属性")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出所有的参数")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flags")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看指定的 jvm 参数的值")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启/关闭指定的JVM参数")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" +PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置flag的参数")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前 jvm 进行的全部的系统属性")]),s._v("\njinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sysprops")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("jinfo参数：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("no option 输出全部的参数和系统属性\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" name 输出对应名称的参数\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("name 开启或者关闭对应名称的参数\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("value 设定对应名称的参数\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flags")]),s._v(" 输出全部的参数\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sysprops")]),s._v(" 输出系统属性\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"_5-1-4-jmap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-4-jmap"}},[s._v("#")]),s._v(" 5.1.4 jmap")]),s._v(" "),a("blockquote",[a("p",[s._v("命令jmap是一个多功能的命令。它可以生成 java 程序的 dump 文件， 也可以查看堆内对象示例的统计信息、查看 ClassLoader 的信息以及 finalizer 队列。")])]),s._v(" "),a("p",[s._v("两个用途")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看堆的情况")]),s._v("\njmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-heap")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dump")]),s._v("\njmap -dump:live,format"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/heap2.bin "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\njmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-dump:format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/heap3.bin "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看堆的占用")]),s._v("\njmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-histo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2815")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-10")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("jmap参数")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("no option： 查看进程的内存映像信息,类似 Solaris pmap 命令。\nheap： 显示Java堆详细信息\nhisto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":live"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("： 显示堆中对象的统计信息\nclstats：打印类加载器信息\nfinalizerinfo： 显示在F-Queue队列等待Finalizer线程执行finalizer方法的对象\ndump:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dump-options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("：生成堆转储快照\nF： 当-dump没有响应时，使用-dump或者-histo参数. 在这个模式下,live子参数无效.\nhelp：打印帮助信息\nJ"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("flag"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("：指定传递给运行jmap的JVM的参数\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"六、9种常见的cms-gc问题分析与解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、9种常见的cms-gc问题分析与解决"}},[s._v("#")]),s._v(" 六、9种常见的CMS GC问题分析与解决")]),s._v(" "),a("p",[s._v("https://www.cnblogs.com/qiuhong10/p/7678046.html")]),s._v(" "),a("h2",{attrs:{id:"七、程序中出现死锁排查过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、程序中出现死锁排查过程"}},[s._v("#")]),s._v(" 七、程序中出现死锁排查过程")]),s._v(" "),a("h3",{attrs:{id:"_7-1-使用jps-jstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-使用jps-jstack"}},[s._v("#")]),s._v(" 7.1 使用jps + jstack")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("在windows命令窗口，输入 "),a("code",[s._v("jps -l")]),s._v(",查询进程ID")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225154713.png",alt:"image-20211225154713150"}})])]),s._v(" "),a("li",[a("p",[s._v("输入"),a("code",[s._v("jstack -l 23056")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211227105305.png",alt:"image-20211225154636335"}})])])]),s._v(" "),a("h3",{attrs:{id:"_7-2-使用-jconsole"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-使用-jconsole"}},[s._v("#")]),s._v(" 7.2 使用 jconsole")]),s._v(" "),a("p",[s._v("在window打开 JConsole，JConsole是一个图形化的监控工具！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225154839.png",alt:"image-20211225154839786"}})]),s._v(" "),a("p",[s._v("选择要查看的进程，建立连接")]),s._v(" "),a("p",[s._v("来到线程页面，选择检测死锁")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225155011.png",alt:"image-20211225155011428"}}),s._v(" "),a("p",[s._v("如果存在死锁，则可以直接看到")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225155050.png",alt:"image-20211225155050616"}})]),s._v(" "),a("h3",{attrs:{id:"_7-3-使用-jvisualvm工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-使用-jvisualvm工具"}},[s._v("#")]),s._v(" 7.3 使用 jvisualvm工具")]),s._v(" "),a("p",[s._v("jvisualvm是一个图形化的监控工具，打开工具后选择要查看的进程，可以选择线程，查看是否存在死锁，可以利用线程可视化查看造成死锁的线程，也可以生成线程Dump查看死锁的线程。同时，该工具还可以监控"),a("strong",[s._v("CPU，堆，类，线程")]),s._v("的运行情况。")]),s._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225155452.png",alt:"image-20211225155452316"}}),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225155711.png",alt:"image-20211225155711244"}})]),s._v(" "),a("h2",{attrs:{id:"八、java-cpu-100-排查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八、java-cpu-100-排查"}},[s._v("#")]),s._v(" 八、Java CPU 100% 排查")]),s._v(" "),a("ol",[a("li",[s._v("使用 "),a("code",[s._v("top")]),s._v(" 命令查看 CPU 占用资源较高的 PID")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225200521.png",alt:"top命令"}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[s._v("【JDK】通过 "),a("code",[s._v("jps")]),s._v(" 找到当前用户下的 java程序 PID")]),s._v(" "),a("p",[s._v("【Linux】通过"),a("code",[s._v("ps aux | grep PID")]),s._v("命令")]),s._v(" "),a("blockquote",[a("p",[s._v("执行 jps -l 能够打印出所有的应用的PID，找到有一个PID和这个cpu使用100%一样的ID！！就知道是哪一个服务了。")])])]),s._v(" "),a("li",[a("p",[s._v("【JDK】使用 "),a("code",[s._v("pidstat -p 3455 -u -t")]),s._v(" 找到CPU占用较高的线程")]),s._v(" "),a("p",[s._v("【Linux】使用 "),a("code",[s._v("ps -mp pid -o")]),s._v("  显示THREAD,tid,time 显示线程列表")]),s._v(" "),a("blockquote",[a("p",[s._v("pidstat是sysstat工具的一个命令，用于监控全部或指定进程的cpu、内存、线程、设备IO等系统资源的占用情况。")])])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/jiao_qianjin/zhishiku/raw/master/img/20211225201048.png",alt:"这里写图片描述"}})]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[s._v("将TID转换为十六进制的表示方式")]),s._v(" "),a("p",[s._v("【Linux】"),a("code",[s._v("jstack pid |grep tid -A 30")])])]),s._v(" "),a("li",[a("p",[s._v("通过jstack -l 输出当前进程的线程信息")]),s._v(" "),a("blockquote",[a("p",[s._v("使用jstack 输出当前PID的线程dump信息")])])]),s._v(" "),a("li",[a("p",[s._v("查找 TID对应的线程(输出的线程id为十六进制)，找到对应的代码")])])]),s._v(" "),a("p",[a("strong",[s._v("总结")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("top命令：Linux命令。可以查看实时的CPU使用情况。也可以查看最近一段时间的CPU使用情况。")])]),s._v(" "),a("li",[a("p",[s._v("PS命令：Linux命令。强大的进程状态监控命令。可以查看进程以及进程中线程的当前CPU使用情况。属于当前状态的采样数据。")])]),s._v(" "),a("li",[a("p",[s._v("jstack：Java提供的命令。可以查看某个进程的当前线程栈运行情况。根据这个命令的输出可以定位某个进程的所有线程的当前运行状态、运行代码，以及是否死锁等等。")])])]),s._v(" "),a("h2",{attrs:{id:"九、压力测试如何查看性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#九、压力测试如何查看性能"}},[s._v("#")]),s._v(" 九、压力测试如何查看性能")]),s._v(" "),a("ol",[a("li",[s._v("在进行压力测试的时候，使用"),a("code",[s._v("jps")]),s._v("找到应用的"),a("code",[s._v("PID")])]),s._v(" "),a("li",[s._v("然后使用"),a("code",[s._v("jstack")]),s._v("输出出压力测试时候应用的"),a("code",[s._v("dump")]),s._v("信息")]),s._v(" "),a("li",[s._v("分析输出的日志文件中那个方法"),a("code",[s._v("block")]),s._v("线程占用最多，这里可能是性能有问题，找到对应的代码分析")])]),s._v(" "),a("h2",{attrs:{id:"十、linux查看日志定位问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十、linux查看日志定位问题"}},[s._v("#")]),s._v(" 十、Linux查看日志定位问题")]),s._v(" "),a("h3",{attrs:{id:"定位问题的前后n行日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定位问题的前后n行日志"}},[s._v("#")]),s._v(" 定位问题的前后n行日志")]),s._v(" "),a("p",[s._v("1、定位错误关键字所在行号")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" test.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"查找的错误关键字"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2、得到错误关键字所在行号（假设为第500行），查询错误关键字前后100行数据（表示从第400行开始往后查询200行数据，500行的前后100行）")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" test.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" +400"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"定位时间段内的日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定位时间段内的日志"}},[s._v("#")]),s._v(" 定位时间段内的日志")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" ‘/2019-10-24 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":16:21/,/2019-10-24 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":16:59/p’ all.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"实时查看日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实时查看日志"}},[s._v("#")]),s._v(" 实时查看日志")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" test.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"查询最后20行-并查找关键字-结果-文字标红-上下扩展两行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询最后20行-并查找关键字-结果-文字标红-上下扩展两行"}},[s._v("#")]),s._v(" 查询最后20行，并查找关键字“结果”，文字标红，上下扩展两行")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" test.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'结果'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--color")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);